{% extends "base.html" %}

{% block title %}My Profile - NutriAI{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <!-- Header -->
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10">
        <div>
            <h1
                class="text-3xl md:text-4xl font-bold tracking-tight text-gray-900 dark:text-gray-100 font-serif-accent mb-2">
                My Nutrition Profile</h1>
            <p class="text-gray-600 dark:text-gray-400">Your personalized nutrition and health information based on your
                latest update.</p>
        </div>
        <a href="{{ url_for('profile.setup') }}"
            class="glass-panel px-5 py-2.5 rounded-xl text-sm font-medium hover:bg-white/80 dark:hover:bg-gray-800/80 transition-all shadow-sm hover:shadow-md flex items-center space-x-2 group">
            <i class="ph ph-pencil-simple text-lg text-green-600 dark:text-green-400"></i>
            <span
                class="text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors">Edit
                Profile</span>
        </a>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Basic Information -->
        <div class="glass-panel rounded-2xl p-6 lg:p-8 flex flex-col h-full hover:shadow-lg transition-shadow">
            <div class="flex items-center space-x-4 mb-8">
                <div
                    class="w-12 h-12 bg-green-100/50 dark:bg-green-900/30 rounded-2xl flex items-center justify-center border border-green-200/50 dark:border-green-800/30">
                    <i class="ph ph-user text-2xl text-green-600 dark:text-green-400"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 font-serif-accent">Basic Info</h2>
            </div>

            {% if profile %}
            <div class="space-y-6 flex-1">
                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Age</label>
                        <p class="text-xl font-medium text-gray-900 dark:text-gray-100">{{ profile.age }} <span
                                class="text-sm font-normal text-gray-500">years</span></p>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Sex</label>
                        <p class="text-xl font-medium text-gray-900 dark:text-gray-100 capitalize">{{
                            profile.biological_sex.replace('_', ' ') if profile.biological_sex else '-' }}</p>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label
                            class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Height</label>
                        <p class="text-xl font-medium text-gray-900 dark:text-gray-100">
                            {% if profile.height_cm %}
                            {{ ((profile.height_cm / 2.54) // 12)|int }}'{{ ((profile.height_cm / 2.54) %
                            12)|round(0)|int }}"
                            <span class="text-sm font-normal text-gray-500 block">{{ profile.height_cm }} cm</span>
                            {% else %}-{% endif %}
                        </p>
                    </div>
                    <div>
                        <label
                            class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Weight</label>
                        <p class="text-xl font-medium text-gray-900 dark:text-gray-100">
                            {% if profile.weight_kg %}
                            {{ (profile.weight_kg * 2.20462)|round(1) }} lbs
                            <span class="text-sm font-normal text-gray-500 block">{{ profile.weight_kg }} kg</span>
                            {% else %}-{% endif %}
                        </p>
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Activity
                        Level</label>
                    <p class="text-lg font-medium text-gray-900 dark:text-gray-100 capitalize">
                        {% if profile.activity_level %}
                        {{ profile.activity_level.replace('_', ' ') }}
                        {% else %}-{% endif %}
                    </p>
                </div>

                {% if profile.health_conditions and profile.health_conditions != ['none'] %}
                <div class="pt-4 border-t border-gray-100 dark:border-gray-800">
                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Health
                        Conditions</label>
                    <div class="flex flex-wrap gap-2">
                        {% for condition in profile.health_conditions %}
                        {% if condition != 'none' %}
                        <span
                            class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100/50 dark:bg-red-900/30 text-red-700 dark:text-red-300 border border-red-200/50 dark:border-red-800/30">
                            {% if condition == 'diabetes_type1' %}Type 1 Diabetes
                            {% elif condition == 'diabetes_type2' %}Type 2 Diabetes
                            {% elif condition == 'hypertension' %}High Blood Pressure
                            {% else %}{{ condition.replace('_', ' ').title() }}
                            {% endif %}
                        </span>
                        {% endif %}
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% else %}
            <div class="text-center py-12">
                <div
                    class="w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ph ph-user-plus text-2xl text-gray-400"></i>
                </div>
                <p class="text-gray-500 mb-6">No profile information yet.</p>
                <a href="{{ url_for('profile.setup') }}"
                    class="btn-primary px-6 py-2 rounded-lg text-sm inline-flex">Set Up Profile</a>
            </div>
            {% endif %}
        </div>

        <!-- Goals & Targets -->
        <div class="glass-panel rounded-2xl p-6 lg:p-8 flex flex-col h-full hover:shadow-lg transition-shadow">
            <div class="flex items-center space-x-4 mb-8">
                <div
                    class="w-12 h-12 bg-blue-100/50 dark:bg-blue-900/30 rounded-2xl flex items-center justify-center border border-blue-200/50 dark:border-blue-800/30">
                    <i class="ph ph-target text-2xl text-blue-600 dark:text-blue-400"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 font-serif-accent">Goals</h2>
            </div>

            {% if goals %}
            <div class="space-y-6 flex-1">
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Primary
                        Goal</label>
                    <p class="text-xl font-bold text-blue-600 dark:text-blue-400">
                        {{ goals.goal_type.replace('_', ' ').title() if goals.goal_type else '-' }}
                    </p>
                </div>

                {% if goals.target_weight_kg %}
                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Target
                            Weight</label>
                        <p class="text-lg font-medium text-gray-900 dark:text-gray-100">
                            {{ (goals.target_weight_kg * 2.20462)|round(1) }} lbs
                        </p>
                    </div>
                    {% if goals.timeline_weeks %}
                    <div>
                        <label
                            class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Timeline</label>
                        <p class="text-lg font-medium text-gray-900 dark:text-gray-100">{{ goals.timeline_weeks }} weeks
                        </p>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

                {% if goals.daily_calories %}
                <div class="bg-gray-50/50 dark:bg-black/20 rounded-xl p-5 border border-gray-100 dark:border-gray-800">
                    <h3 class="text-xs font-bold uppercase tracking-wider text-gray-500 mb-4">Daily Targets</h3>
                    <div class="grid grid-cols-2 gap-y-4 gap-x-4">
                        <div class="text-center p-2 rounded-lg bg-white/50 dark:bg-white/5">
                            <div class="text-2xl font-bold text-gray-900 dark:text-white">{{ goals.daily_calories }}
                            </div>
                            <div class="text-[10px] uppercase font-bold text-gray-500">Calories</div>
                        </div>
                        <div class="text-center p-2 rounded-lg bg-white/50 dark:bg-white/5">
                            <div class="text-xl font-bold text-gray-900 dark:text-white">{{ goals.protein_grams }}g
                            </div>
                            <div class="text-[10px] uppercase font-bold text-gray-500">Protein</div>
                        </div>
                        <div class="text-center p-2 rounded-lg bg-white/50 dark:bg-white/5">
                            <div class="text-xl font-bold text-gray-900 dark:text-white">{{ goals.carbs_grams }}g</div>
                            <div class="text-[10px] uppercase font-bold text-gray-500">Carbs</div>
                        </div>
                        <div class="text-center p-2 rounded-lg bg-white/50 dark:bg-white/5">
                            <div class="text-xl font-bold text-gray-900 dark:text-white">{{ goals.fat_grams }}g</div>
                            <div class="text-[10px] uppercase font-bold text-gray-500">Fat</div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            {% else %}
            <div class="text-center py-12">
                <p class="text-gray-500">No goals set yet.</p>
            </div>
            {% endif %}
        </div>

        <!-- Diet Preferences -->
        <div class="glass-panel rounded-2xl p-6 lg:p-8 flex flex-col h-full hover:shadow-lg transition-shadow">
            <div class="flex items-center space-x-4 mb-8">
                <div
                    class="w-12 h-12 bg-purple-100/50 dark:bg-purple-900/30 rounded-2xl flex items-center justify-center border border-purple-200/50 dark:border-purple-800/30">
                    <i class="ph ph-fork-knife text-2xl text-purple-600 dark:text-purple-400"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 font-serif-accent">Preferences</h2>
            </div>

            {% if preferences %}
            <div class="space-y-6 flex-1">
                {% if preferences.diet_type %}
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Diet Type</label>
                    <p class="text-lg font-medium text-purple-600 dark:text-purple-400 font-serif-accent">
                        {{ preferences.diet_type.replace('_', ' ').title() }}
                    </p>
                </div>
                {% endif %}

                {% if preferences.allergies %}
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Allergies</label>
                    <div class="flex flex-wrap gap-2">
                        {% for allergy in preferences.allergies %}
                        <span
                            class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100/50 dark:bg-red-900/30 text-red-700 dark:text-red-300 border border-red-200/50 dark:border-red-800/30">
                            {{ allergy.capitalize() }}
                        </span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <div class="grid grid-cols-2 gap-6 pt-4 border-t border-gray-100 dark:border-gray-800">
                    {% if preferences.cooking_skill %}
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Cooking
                            Skill</label>
                        <p class="text-md font-medium text-gray-900 dark:text-gray-100 capitalize">{{
                            preferences.cooking_skill }}</p>
                    </div>
                    {% endif %}

                    {% if preferences.budget_per_meal %}
                    <div>
                        <label
                            class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1">Budget/Meal</label>
                        <p class="text-md font-medium text-gray-900 dark:text-gray-100">${{
                            "%.2f"|format(preferences.budget_per_meal) }}</p>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% else %}
            <div class="text-center py-12">
                <p class="text-gray-500">No preferences set.</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Profile Actions -->
    <div class="mt-12 flex flex-col sm:flex-row gap-4 justify-center">
        <a href="{{ url_for('index') }}"
            class="btn-primary px-8 py-3 rounded-xl shadow-lg hover:shadow-green-500/20 flex items-center justify-center space-x-2 w-full sm:w-auto transform hover:-translate-y-1 transition-all">
            <i class="ph ph-camera text-xl"></i>
            <span class="font-bold">Analyze a Meal</span>
        </a>
        <a href="{{ url_for('history') }}"
            class="glass-panel px-8 py-3 rounded-xl hover:bg-white/80 dark:hover:bg-gray-800/80 transition-all flex items-center justify-center space-x-2 w-full sm:w-auto text-gray-900 dark:text-white font-medium shadow-sm hover:shadow-md">
            <i class="ph ph-clock-counter-clockwise text-xl"></i>
            <span>View History</span>
        </a>
    </div>
</div>
{% endblock %}